<!DOCTYPE html>
<html>
<title>Open Census Apllication</title>
 <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="http://www.w3schools.com/lib/w3.css">
<link rel="stylesheet" href="http://www.w3schools.com/lib/w3-theme-black.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto">
<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css">
<style>
html,body,h1,h2,h3,h4,h5,h6 {font-family: "Roboto", sans-serif}
.w3-sidenav a,.w3-sidenav h4{padding:12px;}
.w3-navbar a{padding-top:12px !important;padding-bottom:12px !important;}
      #map {
        height: 600px;
      }
</style>
<body>

 <!-- Navbar -->
<ul class="w3-navbar w3-theme w3-top w3-left-align w3-large" style="z-index:4;">
  <li class="w3-opennav w3-right w3-hide-large">
    <a class="w3-hover-white w3-large w3-theme-l1" href="javascript:void(0)" onclick="w3_open()"><i class="fa fa-bars"></i></a>
  </li>
  <li><a href="#" class="w3-theme-l1">GISJohn</a></li>
  <li class="w3-hide-small"><a href="#" class="w3-hover-white">Home</a></li>
  <li class="w3-hide-small"><a href="#" class="w3-hover-white">What is this?</a></li>
  <li class="w3-hide-small"><a href="#" class="w3-hover-white">New Application</a></li>
  <li class="w3-hide-small"><a href="#" class="w3-hover-white">Contact</a></li>
  <li class="w3-hide-medium w3-hide-small"><a href="#" class="w3-hover-white">Clients</a></li>
  <li class="w3-hide-medium w3-hide-small"><a href="#" class="w3-hover-white">Partners</a></li>
</ul>
    <title>Open Census App</title>
    Layers:
<<!-- Sidenav -->
<nav class="w3-sidenav w3-collapse w3-theme-l5 w3-animate-left" style="z-index:3;width:250px;margin-top:21px;">
  <a href="javascript:void(0)" onclick="w3_close()" class="w3-right w3-xlarge w3-padding-large w3-hover-black w3-hide-large" title="close menu">
    <i class="fa fa-remove"></i>
  </a>
  <h4><b>Menu</b></h4>
<select id="Collection"> <!--//The Id of the drop down list that will change the layers based on their table id-->
    
  <option value="">----Select Dataset----</option>
  <option value="172FC7hM8mO9cDQzgAs4zRFBCWQMcqp1u_jLYWAmv">Unemployment</option> <!--//value is the id of the table-->
  <option value="13ZN5UX5Qk-gQcx0q6Zs-w28oGhgx4R3m-sxwU3O-">Mangroves</option>
    <option value="1nRmxoGAlKTOpf58DHBXa-AE0Vptdkj9U0PdLgOtr">March</option>
    <option value="1NAY256IT53gtPoN2Ic5J66zJNHJ-scFUtdRA7qLW">CNSB</option>
  </select>
 
 <!--//The Drop down menu that will display the markers of selected species-->
    <select id="delivery" onchange="updateMap();"> <!--//When a value is selected the the updateMap(); is activated-->
      <option value="">----Province---
<option value="Eastern Cape">Eastern Cape</option>
<option value="Western Cape">Western Cape</option>
<option value="Free State">Free State</option>
<option value="Limpopo">Limpopo</option>
<option value="Mpumalanga">Mpumalanga</option>
<option value="North West">North West</option>
<option value="Northern Cape">Northern Cape</option>
<option value="KwaZulu-Natal">KwaZulu-Natal</option>
<option value="Gauteng">Gauteng</option>
</option>     
</select>
</nav>

<!-- Overlay effect when opening sidenav on small screens -->
<div class="w3-overlay w3-hide-large" onclick="w3_close()" style="cursor:pointer" title="close side menu"></div>

<!-- Main content: shift it to the right by 250 pixels when the sidenav is visible -->
<div class="w3-main" style="margin-left:250px">

<link href="https://developers.google.com/fusiontables/docs/samples/style/default.css"
        rel="stylesheet" type="text/css">
    <script type="text/javascript"
        src="http://maps.google.com/maps/api/js?key=AIzaSyBbC9hHZT51Sm2ZCFok4ciJg_9iyss8h4A&sensor=false"></script> <!--//My Api Used-->
    
    <script type="text/javascript">
      function initialize() { //Initialize the function that is going to create the map 
        var baseId = '172FC7hM8mO9cDQzgAs4zRFBCWQMcqp1u_jLYWAmv'; //creating variable for the main specie table layer id
        var baseColumn = 'geometry'; //creating a variable for the locationcollumn of the table

        var map = new google.maps.Map(document.getElementById('map-canvas'), { //create a variable for the google map
          center: new google.maps.LatLng(-26, 25), //centre it over guinea
          zoom: 5, //zoom level where all points are visible
          mapTypeId: google.maps.MapTypeId.ROADMAP //the maptypeId
        });
        var infoWindow = new google.maps.InfoWindow(); //create a variable for the infowindows
        
        
        var layer = new google.maps.FusionTablesLayer({ //create a variable for the main specie table layer
          query: {
            select: baseColumn, //select values from the location column(the geocoded column)
            from: baseId //the table id variable
          },
          map: map, //display it on the map upon load
          styleId: 2, //styles of markers etc match those specified in fusion table
          templateId: 2, //template id match that of fusion table
          options: {
            suppressInfoWindows: true
          }
        });
        
        google.maps.event.addListener(layer, 'click', function(e) { //create a click listener for the info window
          infoWindow.setContent(e.infoWindowHtml + //set the content for the info window, here i have said i want the info window to match the info window i have set up for that table
                                '<button id="myButton" class="float-left submit-button" >Click to view Interactive Table</button>'); //add a button that will open a window displaying the specie table, users can filter values and add new values from here
          infoWindow.setPosition(e.latLng); //set the info window position
          infoWindow.open(map); //open the info window
          document.getElementById("myButton").onclick = function () { //create the onclick funtion of the button that will open the window
            window.open("https://www.google.com/fusiontables/DataSource?docid=1qK80aa74L4SWqWxPoaNb3_Q8hIJ6MiPXdec4waFQ", "_blank", "toolbar=no, scrollbars=yes, resizable=yes, top=500, left=500, width=800, height=800"); //create the constraints for the new window, width content etc content must be link to fusion table with filter option and toolbar for adding data
}
      });
        
 var layer1 = new google.maps.FusionTablesLayer({ //Load Unemployment 2011 Layer
        query: {
          select: 'geometry', //select from the location column of table
          from:'172FC7hM8mO9cDQzgAs4zRFBCWQMcqp1u_jLYWAmv' //table id
        },
        
   styleId: 2, //style id matches that was specified in fusion table features
   templateId: 2, //teplate id matches that of fusion table
        options: {
            suppressInfoWindows: true
          }
        });

        google.maps.event.addListener(layer1, 'click', function(e) { //create a click listener for the info window
          infoWindow.setContent(e.infoWindowHtml + //set the content for the info window, here i have said i want the info window to match the info window i have set up for that table
               '<button id="myButton" class="float-left submit-button" >Click to view Interactive Table</button>');//add a button that will open a window displaying the specie table, users can filter values and add new values from here
        
          infoWindow.setPosition(e.latLng);//set the info window position
          infoWindow.open(map);//open the info window
          document.getElementById("myButton").onclick = function () { //create the onclick funtion of the button that will open the window
        
            window.open("https://www.google.com/fusiontables/DataSource?docid=1qK80aa74L4SWqWxPoaNb3_Q8hIJ6MiPXdec4waFQ", "_blank", "toolbar=yes, scrollbars=yes, resizable=yes, top=500, left=500, width=800, height=800"); //create the constraints for the new window, width content etc content must be link to fusion table with filter option and toolbar for adding data

}
      });
          var layer2 = new google.maps.FusionTablesLayer({ //Load ArcTableMangrove Layer
        query: {
          select: 'LONDD',
          from:'13ZN5UX5Qk-gQcx0q6Zs-w28oGhgx4R3m-sxwU3O-'
        },
        styleId: 2,
             templateId: 2,
        options: {
            suppressInfoWindows: true
          }
        });

        google.maps.event.addListener(layer1, 'click', function(e) {
          infoWindow.setContent(e.infoWindowHtml +
              '<button id="myButton" class="float-left submit-button" >Click to view Interactive Table</button>');
          infoWindow.setPosition(e.latLng);
          infoWindow.open(map);
          document.getElementById("myButton").onclick = function () {
         window.open("https://www.google.com/fusiontables/DataSource?docid=1qK80aa74L4SWqWxPoaNb3_Q8hIJ6MiPXdec4waFQ", "_blank", "toolbar=yes, scrollbars=yes, resizable=yes, top=500, left=500, width=800, height=800");
}
        
      });
   var layer3 = new google.maps.FusionTablesLayer({ //Load ArcTableMarch Layer
        query: {
            select: 'LONDD',
            from: '1nRmxoGAlKTOpf58DHBXa-AE0Vptdkj9U0PdLgOtr'
        },
        styleId: 2,
      templateId: 2,
        options: {
            suppressInfoWindows: true
          }
        });

        google.maps.event.addListener(layer3, 'click', function(e) {
          infoWindow.setContent(e.infoWindowHtml +
              '<button id="myButton" class="float-left submit-button" >Click to view Interactive Table</button>');
          infoWindow.setPosition(e.latLng);
          infoWindow.open(map);
          document.getElementById("myButton").onclick = function () {
         window.open("https://www.google.com/fusiontables/DataSource?docid=1qK80aa74L4SWqWxPoaNb3_Q8hIJ6MiPXdec4waFQ", "_blank", "toolbar=yes, scrollbars=yes, resizable=yes, top=500, left=500, width=800, height=800");
}
    });
   var layer4 = new google.maps.FusionTablesLayer({ //Load ArcTableCNSB Layer
        query: {
            select: 'LONDD',
            from: '1NAY256IT53gtPoN2Ic5J66zJNHJ-scFUtdRA7qLW'
        },
        styleId: 2,
        templateId: 2,
        options: {
            suppressInfoWindows: true
          }
        });
         google.maps.event.addListener(layer4, 'click', function(e) {
          infoWindow.setContent(e.infoWindowHtml +
              '<button id="myButton" class="float-left submit-button" >Click to view Interactive Table</button>');
          infoWindow.setPosition(e.latLng);
          infoWindow.open(map);
          document.getElementById("myButton").onclick = function () {
         window.open("https://www.google.com/fusiontables/DataSource?docid=1qK80aa74L4SWqWxPoaNb3_Q8hIJ6MiPXdec4waFQ", "_blank", "toolbar=yes, scrollbars=yes, resizable=yes, top=500, left=500, width=800, height=800");
}
    });
           google.maps.event.addDomListener(document.getElementById('delivery'), //create listener for the drop down menu
                                            'change', function() { //initialize the function that will sort the layers
                                              updateMap(layer, baseId, baseColumn); //update the map based on the following variables
        });

           function updateMap(layer, baseId, baseColumn) { //this is the function to update the map based on the specified variables
             var province = document.getElementById('delivery').value; //create specie variable the will select values based from species in the drop down list
             if (province) { //create method to update the map by value selected from drop down list
          layer.setOptions({
            query: {
              select: baseColumn, //select values location from location column variable
              from: baseId, //select the main species table
              where: "PROVNAME = '" + province + "'" //specify that the values displayed from table must match the value from dropdown list by their SpecieID
            },
            suppressInfoWindows: true
          });
             } else { //if it doesnt match the above specifications 
          layer.setOptions({
            query: {
              select: baseColumn,
              from: baseId
            }
          });
        }
      }
           google.maps.event.addDomListener(document.getElementById('Collection'), 'change', function () { //create the click listener for the collection dropdown list
        
      /* 
       
             if (this.value == "layer1") { <!--If the value selected is the ArcTableJan turn all layers off but it-->
            layer1.setMap(map);
            layer2.setMap(null);
            layer3.setMap(null);
            layer4.setMap(null);
             layer.setMap(null);
        }  else if (this.value == "layer2") { <!--If the value selected is the ArcTableMangrove turn all layers off but it-->
            layer1.setMap(null);
            layer2.setMap(map);
            layer3.setMap(null);
            layer4.setMap(null);
         layer.setMap(null);
    }      else if (this.value == "layer3") { <!--If the value selected is the ArcTableMarch turn all layers off but it-->
            layer1.setMap(null);
            layer2.setMap(null);
            layer3.setMap(map);
            layer4.setMap(null);
            layer.setMap(null);
    }
         else if (this.value == "layer4") { <!--If the value selected is the ArcTableCNSB turn all layers off but it-->
            layer1.setMap(null);
            layer2.setMap(null);
            layer3.setMap(null);
            layer4.setMap(map);
         layer.setMap(null);
    }
*/
         var newCollectionlayer = this.value; //create variable that selects the values for the new layer to be displayed
        layer.setOptions({
            query: {
              select: 'geometry', //select from location column
              from: newCollectionlayer 
            }
        });
    });
}

          
  

                                       google.maps.event.addDomListener(window, 'load', initialize); //load the AddDOMLSItener

    </script>
  
    <div id="map-canvas" width="100%"></div>  
  </div>

  <footer id="myFooter">
    <div class="w3-container w3-theme-l2 w3-padding-hor-32">
      <h4>Footer</h4>
    </div>

    <div class="w3-container w3-theme-l1">
      <p>Powered by <a href="http://www.w3schools.com/w3css/default.asp" target="_blank">w3.css</a></p>
    </div>
  </footer>

<!-- END MAIN -->
</div>

<script>
// Script to open and close the sidenav
function w3_open() {
    document.getElementsByClassName("w3-sidenav")[0].style.display = "block";
    document.getElementsByClassName("w3-overlay")[0].style.display = "block";
}
 
function w3_close() {
    document.getElementsByClassName("w3-sidenav")[0].style.display = "none";
    document.getElementsByClassName("w3-overlay")[0].style.display = "none";
}
</script>

</body>
</html>

