<!DOCTYPE html>
<html>
  <head>
    <title>Data Layer: Dynamic Styling</title>
    <meta name="viewport" content="initial-scale=1.0">
    <meta charset="utf-8">
    <style>
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
      #map {
        height: 100%;
      }
    </style>
  </head>
  <body>
    <div id="map"></div>
    <script>
      var labels=[]; 
      var map;
      function initMap() {
        map = new google.maps.Map(document.getElementById('map'), {
          zoom: 14,
          center: {lat: -26.17383011, lng: 28.72778439}
        });

		labels[1] = new google.maps.KmlLayer({
    url: 'https://GISJohnECS.github.io/LabelLeeuwPanRoadNew.kmz',
    zIndex: 2,
    preserveViewport: true,
	//map: map
  });  
		
        // Load GeoJSON.
        map.data.loadGeoJson('https://GISJohnECS.github.io/RoadNameJSON.geojson');

        // Color each letter gray. Change the color when the isColorful property
        // is set to true.
        map.data.setStyle(function(feature) {
          var color = 'tan';
          if (feature.getProperty('isColorful')) {
            color = feature.getProperty('Colour');
          }
          return /** @type {google.maps.Data.StyleOptions} */({
            fillColor: color,
			fillOpacity: 0.75,
            strokeColor: 'black',
            strokeWeight: 0.5
          });
        });

		google.maps.event.addListener(map, 'zoom_changed', function() {
    zoomLevel = map.getZoom();
    if (zoomLevel <= 18) {
        labels[1].setMap(map);
    } 
	else {
        labels[1].setMap(null);
    }
});
        var infowindow = new google.maps.InfoWindow();
        // When the user clicks, set 'isColorful', changing the color of the letters.
        map.data.addListener('click', function(event) {
		  var GPSLogID =   event.feature.getProperty('GPSlogId');
	  var CreatedDate =   event.feature.getProperty('table_startdatetime');
	  var RoadNam=   event.feature.getProperty('table_roadname');
	  var pp = [];
	  var i;
	  var jj;
	  var newHTML = [];

		var jj = newHTML.join("");
		
	  var myHTMLss = '<table>' +
	         jj +
			 '<tr><td><b>Road Name:</b></td><td>'+RoadNam+'</td></tr>'  +
	      '<tr><td><b>GPSLogId:</b></td><td>'+GPSLogID+'</td></tr>' + 
		  '<tr><td><b>Created Date and Time:</b></td><td>'+CreatedDate+'</td></tr>' +
		  '<td colspan = 4><img src="https://googledrive.com/host/0By8aK2KY8i6wcmdlZ0x0WDd5aVk/ecs_logo.jpg" alt="" border=0 height=100 width=125></img></td>' +
	      '</table>';
      infowindow.setContent(myHTMLss);
      infowindow.setPosition(event.latLng);
      infowindow.setOptions({pixelOffset: new google.maps.Size(0,-30), Zoom: 30});
      infowindow.open(map);
          event.feature.setProperty('isColorful', true);
        });


        // When the user hovers, tempt them to click by outlining the letters.
        // Call revertStyle() to remove all overrides. This will use the style rules
        // defined in the function passed to setStyle()
        map.data.addListener('mouseover', function(event) {
          map.data.revertStyle();
          map.data.overrideStyle(event.feature, {strokeWeight: 1});
        });

        map.data.addListener('mouseout', function(event) {
          map.data.revertStyle();
        });
      }
    </script>
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBbC9hHZT51Sm2ZCFok4ciJg_9iyss8h4A&callback=initMap">
    </script>
  </body>
</html>
